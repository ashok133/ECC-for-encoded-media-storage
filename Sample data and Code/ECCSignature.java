/*import java.math.BigInteger;
import java.security.*;
import java.security.spec.*;

public class ECCSignature {
  public static void main(String[] args) throws Exception {
    KeyPairGenerator kpg;
    kpg = KeyPairGenerator.getInstance("EC","SunEC");

    ECGenParameterSpec ecsp;
    ecsp = new ECGenParameterSpec("sect163k1");
    kpg.initialize(ecsp);

    KeyPair kp = kpg.genKeyPair();
    PrivateKey privKey = kp.getPrivate();
    PublicKey pubKey = kp.getPublic();
    System.out.println(privKey.toString());
    System.out.println(pubKey.toString());
    
    Signature ecdsa;
    ecdsa = Signature.getInstance("SHA1withECDSA","SunEC");
    ecdsa.initSign(privKey);

    String text1 = "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 BQTjrgE9cdcekrbmymlp27lgJSmtnIHqQoLEDPTJx8ek2gpdw1A2rJqy11zLmfJczh7YdqAV5ZJV Oah7SuzUinNctXdY48YtWeBEitSo8FBUMJuUwZ6v3t7J2fYdWrZ5XZouXcuapO0LDhxxwG+XoDy9 T0XBLECeW8L718b5tnFdd1PF6kHMZ5NcSqAcORHVTknCj1JAmpUSzeyVLkbQrZZCOCIliklHrxea cxMbXUK3JzklLOmcDGTdjeLoKs00yJMmrlZTtOUiJzCHDwoJNoqGBlc5P4lkRQPwyW6k/KB8zFVV mHrTaBeKCOrJkf4g9R19egyOuSRxUMzKD0Z1KQqr5GKtN5iq3MOFHZkoqYlbE3cKxjCXfQL2dbu0 odxDP2DSVjVkjtWzpeYACgcGQpnIc2UYWAFOuQCQAWIzniOKgsxbAAFYf5mrU4NtYaQFSCylSoOA cgA9FbOWwFAVw+bCg4h2GRXZxs71ePWldXeTdyfQkwYWQxysoa2x0OuWekNOt6sm7hHdSLsCOfSr XafFVq6i2ztkqmQXSTZNJyYsZt/6g6448lfiTyUjkDaDhgSmM1j5y4RRkuy46V/uVFwrxmspz5DI wvC1iSpAY8e1gqAWbOEDHGYoypd2fSKcQlOlLK8yCbuNKvbnz1irIRE5OwbVFvDwEopa5WzRdcdn jo6uhNSjlQqaPdirroJKyBlK88/KK2c9DkBUR2+UAv8AKtiliFKDFgLg1W8LAKlgispZn4j5lwfn avPIkKBzXHzMGPJCFxbWXwEyVSNi6zIMLuefPPNJty5Tjk7W2axww9lla6QqMjNRUU0lk3oxRlQF sZQyAiKaxUzgAGwGDNhfQKpzlSPmGcDiSCMYIYEqwIZSVIJz6MyEjmr8cdcj5Vb5gQCp+bBVgGGM EAhgI54xLe2kj9mufZc2iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z 7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4 iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjx iW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8Ylv bSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20k fs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7N c+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPs uIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI 8YlvbSR+zXPsuIjxiW9tJH7Nc+y4iPGJb20kfs1z7LiI8YlvbSR+zXPsuImcrNmskXZK/JxlgnI6 SjpyJfx8gwln7N8wfM37dw0eM3bdwm4au2rhMp01CGKchygYogIAOIn9aOgv7CdK/kl1x7zobETU LqV3R1OG6otXdM3S/LathJ2x6gt+07bLbPgJCZjGTWGmvDIpIFo1YXDArvu6hA+snKJ1CmMIFDPa +D8X4H9A2PO+fXYelNlKkFTBSSy5Pr0OP8ZWte3uiqrGSM9Z53W3fW7etth0AwEM119Wt5N+oXdM 2o5fNZN5q1zM6Hj2KEfcHMcko7kTQTnvy/1opzlBwiblMBRAA9nreI8V7WfzF1pufxR06F6EC0Le SSgPQchgdfwMrmyy/tgYD8j/AIdPjLqhuu7qtvWo9KxNZLqNnvzaXVze+nZCxqV+Ufa/loGjRxVJ O2Iw4vjv2qaUm+TBRRLm5kUDCCRTH4By7faXt7U8ltWX/cnw+v46vZK8gLFaw9E5YwegOAfifWbi +1kUDHcLkfw6SUp9TG6bvqHq/wBP72b0NzsjSOzKNrFza9aoP2VXs6FqUWllEU2Mgqqoi/j0INUq nL2fEqgFMQDlExvwr/8A9G7/AB3tL/a3u73g2uWnzr6msiWEFxy2UssGR6hqqn6dfTOcT9Hf7UPH N5f97vHd8Apo1bGwxHoOFLKp/k7rOxXJuX1xWNudO1fVVUuV/vdMq0EmHadulHWKIAs++EScvITu gooGN5wKsI/I4h/LX2p7h8z+1Ps73r/tc9suze/Pc/uDxehqr15LTuUFdyw4xgGvs0FvgLi3ouR+ yvO+I8Z779w+2f3w80qr7W8L4je29g9OJt1rs69eD6nnzsA+JQD49enUVX2vunfcspUZiQjZKybh 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"; 
    System.out.println("Text: " + text1);
    byte[] baText = buffer.getBytes("UTF-8");


long startTime = System.nanoTime();
    ecdsa.update(text1);
    byte[] baSignature = ecdsa.sign();
    long endTime   = System.nanoTime();
long totalTime = endTime - startTime;
System.out.println(totalTime+"nanoseconds");
    System.out.println("Signature: 0x" + (new BigInteger(1, baSignature).toString(16)).toUpperCase());

    Signature signature;
    signature = Signature.getInstance("SHA1withECDSA","SunEC");
    signature.initVerify(pubKey);
    signature.update(text1);
    boolean result = signature.verify(baSignature);
    System.out.println("Valid: " + result);
  }
}
*/


import java.math.BigInteger;
import java.security.*;
import java.security.spec.*;

public class ECCSignature {
  public static void main(String[] args) throws Exception {
    KeyPairGenerator kpg;

    kpg = KeyPairGenerator.getInstance("EC","SunEC");

    ECGenParameterSpec ecsp;
    ecsp = new ECGenParameterSpec("sect163k1");
    kpg.initialize(ecsp);

    KeyPair kp = kpg.genKeyPair();
    PrivateKey privKey = kp.getPrivate();
    PublicKey pubKey = kp.getPublic();

    System.out.println(privKey.toString());
    System.out.println(pubKey.toString());
    
    long startTime2 = System.nanoTime();
    Signature ecdsa;
    ecdsa = Signature.getInstance("SHA1withECDSA","SunEC");
    ecdsa.initSign(privKey);

        String text = "Chapter6TheladiesofLongbournsoonwaitedonthoseofNetherfield.Thevisitwassoonreturnedindueform.MissBennetspleasingmannersgrewonthegoodwillofMrs.HurstandMissBingley;andthoughthemotherwasfoundtobeintolerable,andtheyoungersistersnotworthspeakingto,awishofbeingbetteracquaintedwith_them_wasexpressedtowardsthetwoeldest.ByJane,thisattentionwasreceivedwiththegreatestpleasure,butElizabethstillsawsuperciliousnessintheirtreatmentofeverybody,hardlyexceptingevenhersister,andcouldnotlikethem;thoughtheirkindnesstoJane,suchasitwas,hadavalueasarisinginallprobabilityfromtheinfluenceoftheirbrothersadmiration.Itwasgenerallyevidentwhenevertheymet,thathe_did_admireherandto_her_itwasequallyevidentthatJanewasyieldingtothepreferencewhichshehadbeguntoentertainforhimfromthefirst,andwasinawaytobeverymuchinlove;butsheconsideredwithpleasurethatitwasnotlikelytobediscoveredbytheworldingeneral,sinceJaneunited,withgreatstrengthoffeeling,acomposureoftemperandauniformcheerfulnessofmannerwhichwouldguardherfromthesuspicionsoftheimpertinent.ShementionedthistoherfriendMissLucas.Itmayperhapsbepleasant,repliedCharlotte,tobeabletoimposeonthepublicinsuchacase;butitissometimesadisadvantagetobesoveryguarded.Ifawomanconcealsheraffectionwiththesameskillfromtheobjectofit,shemaylosetheopportunityoffixinghim;anditwillthenbebutpoorconsolationtobelievetheworldequallyinthedark.Thereissomuchofgratitudeorvanityinalmosteveryattachment,thatitisnotsafetoleaveanytoitself.Wecanall_begin_freely--aslightpreferenceisnaturalenough;butthereareveryfewofuswhohaveheartenoughtobereallyinlovewithoutencouragement.Inninecasesoutoftenawomenhadbettershow_more_affectionthanshefeels.Bingleylikesyoursisterundoubtedly;buthemayneverdomorethanlikeher,ifshedoesnothelphimon.Butshedoeshelphimon,asmuchashernaturewillallow.IfIcanperceiveherregardforhim,hemustbeasimpleton,indeed,nottodiscoverittoo.Remember,Eliza,thathedoesnotknowJanesdispositionasyoudo.Butifawomanispartialtoaman,anddoesnotendeavourtoconcealit,hemustfinditout.Perhapshemust,ifheseesenoughofher.But,thoughBingleyandJanemeettolerablyoften,itisneverformanyhourstogether;and,astheyalwaysseeeachotherinlargemixedparties,itisimpossiblethateverymomentshouldbeemployedinconversingtogether.Janeshouldthereforemakethemostofeveryhalf-hourinwhichshecancommandhisattention.Whensheissecureofhim,therewillbemoreleisureforfallinginloveasmuchasshechooses.Yourplanisagoodone,repliedElizabeth,wherenothingisinquestionbutthedesireofbeingwellmarried,andifIweredeterminedtogetarichhusband,oranyhusband,IdaresayIshouldadoptit.ButthesearenotJanesfeelings;sheisnotactingbydesign.Asyet,shecannotevenbecertainofthedegreeofherownregardnorofitsreasonableness.Shehasknownhimonlyafortnight.ShedancedfourdanceswithhimatMeryton;shesawhimonemorningathisownhouse,andhassincedinedwithhimincompanyfourtimes.Thisisnotquiteenoughtomakeherunderstandhischaracter.Notasyourepresentit.Hadshemerely_dined_withhim,shemightonlyhavediscoveredwhetherhehadagoodappetite;butyoumustrememberthatfoureveningshavealsobeenspenttogether--andfoureveningsmaydoagreatdeal.Yes;thesefoureveningshaveenabledthemtoascertainthattheybothlikeVingt-unbetterthanCommerce;butwithrespecttoanyotherleadingcharacteristic,Idonotimaginethatmuchhasbeenunfolded.Well,saidCharlotte,IwishJanesuccesswithallmyheart;andifsheweremarriedtohimto-morrow,Ishouldthinkshehadasgoodachanceofhappinessasifsheweretobestudyinghischaracterforatwelvemonth.Happinessinmarriageisentirelyamatterofchance.Ifthedispositionsofthepartiesareeversowellknowntoeachotheroreversosimilarbeforehand,itdoesnotadvancetheirfelicityintheleast.Theyalwayscontinuetogrowsufficientlyunlikeafterwardstohavetheirshareofvexation;anditisbettertoknowaslittleaspossibleofthedefectsofthepersonwithwhomyouaretopassyourlife.Youmakemelaugh,Charlotte;butitisnotsound.Youknowitisnotsound,andthatyouwouldneveractinthiswayyourself.OccupiedinobservingMr.Bingleysattentionstohersister,Elizabethwasfarfromsuspectingthatshewasherselfbecominganobjectofsomeinterestintheeyesofhisfriend.Mr.Darcyhadatfirstscarcelyallowedhertobepretty;hehadlookedatherwithoutadmirationattheball;andwhentheynextmet,helookedatheronlytocriticise.Butnosoonerhadhemadeitcleartohimselfandhisfriendsthatshehardlyhadagoodfeatureinherface,thanhebegantofinditwasrendereduncommonlyintelligentbythebeautifulexpressionofherdarkeyes.Tothisdiscoverysucceededsomeothersequallymortifying.Thoughhehaddetectedwithacriticaleyemorethanonefailureofperfectsymmetryinherform,hewasforcedtoacknowledgeherfiguretobelightandpleasing;andinspiteofhisassertingthathermannerswerenotthoseofthefashionableworld,hewascaughtbytheireasyplayfulness.Ofthisshewasperfectlyunaware;toherhewasonlythemanwhomadehimselfagreeablenowhere,andwhohadnotthoughtherhandsomeenoughtodancewith.Hebegantowishtoknowmoreofher,andasasteptowardsconversingwithherhimself,attendedtoherconversationwithothers.Hisdoingsodrewhernotice.ItwasatSirWilliamLucass,wherealargepartywereassembled.WhatdoesMr.Darcymean,saidshetoCharlotte,bylisteningtomyconversationwithColonelForster?ThatisaquestionwhichMr.Darcyonlycananswer.ButifhedoesitanymoreIshallcertainlylethimknowthatIseewhatheisabout.Hehasaverysatiricaleye,andifIdonotbeginbybeingimpertinentmyself,Ishallsoongrowafraidofhim.Onhisapproachingthemsoonafterwards,thoughwithoutseemingtohaveanyintentionofspeaking,MissLucasdefiedherfriendtomentionsuchasubjecttohim;whichimmediatelyprovokingElizabethtodoit,sheturnedtohimandsaid:Didyounotthink,Mr.Darcy,thatIexpressedmyselfuncommonlywelljustnow,whenIwasteasingColonelForstertogiveusaballatMeryton?Withgreatenergy;butitisalwaysasubjectwhichmakesaladyenergetic.Youaresevereonus.Itwillbe_her_turnsoontobeteased,saidMissLucas.Iamgoingtoopentheinstrument,Eliza,andyouknowwhatfollows.Youareaverystrangecreaturebywayofafriend!--alwayswantingmetoplayandsingbeforeanybodyandeverybody!Ifmyvanityhadtakenamusicalturn,youwouldhavebeeninvaluable;butasitis,Iwouldreallyrathernotsitdownbeforethosewhomustbeinthehabitofhearingtheverybestperformers.OnMissLucasspersevering,however,sheadded,Verywell,ifitmustbeso,itmust.AndgravelyglancingatMr.Darcy,Thereisafineoldsaying,whicheverybodyhereisofcoursefamiliarwith:Keepyourbreathtocoolyourporridge;andIshallkeepminetoswellmysong.Herperformancewaspleasing,thoughbynomeanscapital.Afterasongortwo,andbeforeshecouldreplytotheentreatiesofseveralthatshewouldsingagain,shewaseagerlysucceededattheinstrumentbyhersisterMary,whohaving,inconsequenceofbeingtheonlyplainoneinthefamily,workedhardforknowledgeandaccomplishments,wasalwaysimpatientfordisplay.Maryhadneithergeniusnortaste;andthoughvanityhadgivenherapplication,ithadgivenherlikewiseapedanticairandconceitedmanner,whichwouldhaveinjuredahigherdegreeofexcellencethanshehadreached.Elizabeth,easyandunaffected,hadbeenlistenedtowithmuchmorepleasure,thoughnotplayinghalfsowell;andMary,attheendofalongconcerto,wasgladtopurchasepraiseandgratitudebyScotchandIrishairs,attherequestofheryoungersisters,who,withsomeoftheLucases,andtwoorthreeofficers,joinedeagerlyindancingatoneendoftheroom.Mr.Darcystoodneartheminsilentindignationatsuchamodeofpassingtheevening,totheexclusionofallconversation,andwastoomuchengrossedbyhisthoughtstoperceivethatSirWilliamLucaswashisneighbour,tillSirWilliamthusbegan:Whatacharmingamusementforyoungpeoplethisis,Mr.Darcy!Thereisnothinglikedancingafterall.Iconsideritasoneofthefirstrefinementsofpolishedsociety.Certainly,sir;andithastheadvantagealsoofbeinginvogueamongstthelesspolishedsocietiesoftheworld.Everysavagecandance.SirWilliamonlysmiled.Yourfriendperformsdelightfully,hecontinuedafterapause,onseeingBingleyjointhegroup;andIdoubtnotthatyouareanadeptinthescienceyourself,Mr.Darcy.YousawmedanceatMeryton,Ibelieve,sir.Yes,indeed,andreceivednoinconsiderablepleasurefromthesight.DoyouoftendanceatSt.Jamess?Never,sir.Doyounotthinkitwouldbeapropercomplimenttotheplace?ItisacomplimentwhichIneverpaytoanyplaceifIcanavoidit.Youhaveahouseintown,Iconclude?Mr.Darcybowed.Ihadoncehadsomethoughtoffixingintownmyself--forIamfondofsuperiorsociety;butIdidnotfeelquitecertainthattheairofLondonwouldagreewithLadyLucas.Hepausedinhopesofananswer;buthiscompanionwasnotdisposedtomakeany;andElizabethatthatinstantmovingtowardsthem,hewasstruckwiththeactionofdoingaverygallantthing,andcalledouttoher:MydearMissEliza,whyareyounotdancing?Mr.Darcy,youmustallowmetopresentthisyoungladytoyouasaverydesirablepartner.Youcannotrefusetodance,Iamsurewhensomuchbeautyisbeforeyou.And,takingherhand,hewouldhavegivenittoMr.Darcywho,thoughextremelysurprised,wasnotunwillingtoreceiveit,whensheinstantlydrewback,andsaidwithsomediscomposuretoSirWilliam:Indeed,sir,Ihavenottheleastintentionofdancing.IentreatyounottosupposethatImovedthiswayinordertobegforapartner.Mr.Darcy,withgravepropriety,requestedtobeallowedthehonourofherhand,butinvain.Elizabethwasdetermined;nordidSirWilliamatallshakeherpurposebyhisattemptatpersuasion.Youexcelsomuchinthedance,MissEliza,thatitiscrueltodenymethehappinessofseeingyou;andthoughthisgentlemandislikestheamusementingeneral,hecanhavenoobjection,Iamsure,toobligeusforonehalf-hour.Mr.Darcyisallpoliteness,saidElizabeth,smiling.Heis,indeed;but,consideringtheinducement,mydearMissEliza,wecannotwonderathiscomplaisance--forwhowouldobjecttosuchapartner?Elizabethlookedarchly,andturnedaway.Herresistancehadnotinjuredherwiththegentleman,andhewasthinkingofherwithsomecomplacency,whenthusaccostedbyMissBingley:Icanguessthesubjectofyourreverie.Ishouldimaginenot.Youareconsideringhowinsupportableitwouldbetopassmanyeveningsinthismanner--insuchsociety;andindeedIamquiteofyouropinion.Iwasnevermoreannoyed!Theinsipidity,andyetthenoise--thenothingness,andyettheself-importanceofallthosepeople!WhatwouldIgivetohearyourstricturesonthem!Youconjectureistotallywrong,Iassureyou.Mymindwasmoreagreeablyengaged.Ihavebeenmeditatingontheverygreatpleasurewhichapairoffineeyesinthefaceofaprettywomancanbestow.MissBingleyimmediatelyfixedhereyesonhisface,anddesiredhewouldtellherwhatladyhadthecreditofinspiringsuchreflections.Mr.Darcyrepliedwithgreatintrepidity:MissElizabethBennet.MissElizabethBennet!repeatedMissBingley.Iamallastonishment.Howlonghasshebeensuchafavourite?--andpray,whenamItowishyoujoy?ThatisexactlythequestionwhichIexpectedyoutoask.Aladysimaginationisveryrapid;itjumpsfromadmirationtolove,fromlovetomatrimony,inamoment.Iknewyouwouldbewishingmejoy.Nay,ifyouareseriousaboutit,Ishallconsiderthematterisabsolutelysettled.Youwillbehavingacharmingmother-in-law,indeed;and,ofcourse,shewillalwaysbeatPemberleywithyou.Helistenedtoherwithperfectindifferencewhileshechosetoentertainherselfinthismanner;andashiscomposureconvincedherthatallwassafe,herwitflowedlong."; 

    //System.out.println("Text: " + text);
    byte[] baText = text.getBytes("UTF-8");

   
    ecdsa.update(baText);
    byte[] baSignature = ecdsa.sign();
    long endTime2   = System.nanoTime();
long totalTime2 = endTime2 - startTime2;
System.out.println(totalTime2+" NANOSECONDS!");
    System.out.println("Signature: 0x" + (new BigInteger(1, baSignature).toString(16)).toUpperCase());

    Signature signature;
    signature = Signature.getInstance("SHA1withECDSA","SunEC");
    signature.initVerify(pubKey);
    signature.update(baText);
    boolean result = signature.verify(baSignature);
    System.out.println("Valid: " + result);
  }
}