import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.SecureRandom;
import java.security.Security;
import java.security.Signature;
public class RSA2 {
  public static void main(String[] args) throws Exception {
    Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());
    KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA", "BC");
    keyGen.initialize(512, new SecureRandom());
    KeyPair keyPair = keyGen.generateKeyPair();
    Signature signature = Signature.getInstance("SHA1withRSA", "BC");
    long startTime = System.nanoTime();
    signature.initSign(keyPair.getPrivate(), new SecureRandom());
    byte[] message = "Chapter6TheladiesofLongbournsoonwaitedonthoseofNetherfield.Thevisitwassoonreturnedindueform.MissBennetspleasingmannersgrewonthegoodwillofMrs.HurstandMissBingley;andthoughthemotherwasfoundtobeintolerable,andtheyoungersistersnotworthspeakingto,awishofbeingbetteracquaintedwith_them_wasexpressedtowardsthetwoeldest.ByJane,thisattentionwasreceivedwiththegreatestpleasure,butElizabethstillsawsuperciliousnessintheirtreatmentofeverybody,hardlyexceptingevenhersister,andcouldnotlikethem;thoughtheirkindnesstoJane,suchasitwas,hadavalueasarisinginallprobabilityfromtheinfluenceoftheirbrothersadmiration.Itwasgenerallyevidentwhenevertheymet,thathe_did_admireherandto_her_itwasequallyevidentthatJanewasyieldingtothepreferencewhichshehadbeguntoentertainforhimfromthefirst,andwasinawaytobeverymuchinlove;butsheconsideredwithpleasurethatitwasnotlikelytobediscoveredbytheworldingeneral,sinceJaneunited,withgreatstrengthoffeeling,acomposureoftemperandauniformcheerfulnessofmannerwhichwouldguardherfromthesuspicionsoftheimpertinent.ShementionedthistoherfriendMissLucas.Itmayperhapsbepleasant,repliedCharlotte,tobeabletoimposeonthepublicinsuchacase;butitissometimesadisadvantagetobesoveryguarded.Ifawomanconcealsheraffectionwiththesameskillfromtheobjectofit,shemaylosetheopportunityoffixinghim;anditwillthenbebutpoorconsolationtobelievetheworldequallyinthedark.Thereissomuchofgratitudeorvanityinalmosteveryattachment,thatitisnotsafetoleaveanytoitself.Wecanall_begin_freely--aslightpreferenceisnaturalenough;butthereareveryfewofuswhohaveheartenoughtobereallyinlovewithoutencouragement.Inninecasesoutoftenawomenhadbettershow_more_affectionthanshefeels.Bingleylikesyoursisterundoubtedly;buthemayneverdomorethanlikeher,ifshedoesnothelphimon.Butshedoeshelphimon,asmuchashernaturewillallow.IfIcanperceiveherregardforhim,hemustbeasimpleton,indeed,nottodiscoverittoo.Remember,Eliza,thathedoesnotknowJanesdispositionasyoudo.Butifawomanispartialtoaman,anddoesnotendeavourtoconcealit,hemustfinditout.Perhapshemust,ifheseesenoughofher.But,thoughBingleyandJanemeettolerablyoften,itisneverformanyhourstogether;and,astheyalwaysseeeachotherinlargemixedparties,itisimpossiblethateverymomentshouldbeemployedinconversingtogether.Janeshouldthereforemakethemostofeveryhalf-hourinwhichshecancommandhisattention.Whensheissecureofhim,therewillbemoreleisureforfallinginloveasmuchasshechooses.Yourplanisagoodone,repliedElizabeth,wherenothingisinquestionbutthedesireofbeingwellmarried,andifIweredeterminedtogetarichhusband,oranyhusband,IdaresayIshouldadoptit.ButthesearenotJanesfeelings;sheisnotactingbydesign.Asyet,shecannotevenbecertainofthedegreeofherownregardnorofitsreasonableness.Shehasknownhimonlyafortnight.ShedancedfourdanceswithhimatMeryton;shesawhimonemorningathisownhouse,andhassincedinedwithhimincompanyfourtimes.Thisisnotquiteenoughtomakeherunderstandhischaracter.Notasyourepresentit.Hadshemerely_dined_withhim,shemightonlyhavediscoveredwhetherhehadagoodappetite;butyoumustrememberthatfoureveningshavealsobeenspenttogether--andfoureveningsmaydoagreatdeal.Yes;thesefoureveningshaveenabledthemtoascertainthattheybothlikeVingt-unbetterthanCommerce;butwithrespecttoanyotherleadingcharacteristic,Idonotimaginethatmuchhasbeenunfolded.Well,saidCharlotte,IwishJanesuccesswithallmyheart;andifsheweremarriedtohimto-morrow,Ishouldthinkshehadasgoodachanceofhappinessasifsheweretobestudyinghischaracterforatwelvemonth.Happinessinmarriageisentirelyamatterofchance.Ifthedispositionsofthepartiesareeversowellknowntoeachotheroreversosimilarbeforehand,itdoesnotadvancetheirfelicityintheleast.Theyalwayscontinuetogrowsufficientlyunlikeafterwardstohavetheirshareofvexation;anditisbettertoknowaslittleaspossibleofthedefectsofthepersonwithwhomyouaretopassyourlife.Youmakemelaugh,Charlotte;butitisnotsound.Youknowitisnotsound,andthatyouwouldneveractinthiswayyourself.OccupiedinobservingMr.Bingleysattentionstohersister,Elizabethwasfarfromsuspectingthatshewasherselfbecominganobjectofsomeinterestintheeyesofhisfriend.Mr.Darcyhadatfirstscarcelyallowedhertobepretty;hehadlookedatherwithoutadmirationattheball;andwhentheynextmet,helookedatheronlytocriticise.Butnosoonerhadhemadeitcleartohimselfandhisfriendsthatshehardlyhadagoodfeatureinherface,thanhebegantofinditwasrendereduncommonlyintelligentbythebeautifulexpressionofherdarkeyes.Tothisdiscoverysucceededsomeothersequallymortifying.Thoughhehaddetectedwithacriticaleyemorethanonefailureofperfectsymmetryinherform,hewasforcedtoacknowledgeherfiguretobelightandpleasing;andinspiteofhisassertingthathermannerswerenotthoseofthefashionableworld,hewascaughtbytheireasyplayfulness.Ofthisshewasperfectlyunaware;toherhewasonlythemanwhomadehimselfagreeablenowhere,andwhohadnotthoughtherhandsomeenoughtodancewith.Hebegantowishtoknowmoreofher,andasasteptowardsconversingwithherhimself,attendedtoherconversationwithothers.Hisdoingsodrewhernotice.ItwasatSirWilliamLucass,wherealargepartywereassembled.WhatdoesMr.Darcymean,saidshetoCharlotte,bylisteningtomyconversationwithColonelForster?ThatisaquestionwhichMr.Darcyonlycananswer.ButifhedoesitanymoreIshallcertainlylethimknowthatIseewhatheisabout.Hehasaverysatiricaleye,andifIdonotbeginbybeingimpertinentmyself,Ishallsoongrowafraidofhim.Onhisapproachingthemsoonafterwards,thoughwithoutseemingtohaveanyintentionofspeaking,MissLucasdefiedherfriendtomentionsuchasubjecttohim;whichimmediatelyprovokingElizabethtodoit,sheturnedtohimandsaid:Didyounotthink,Mr.Darcy,thatIexpressedmyselfuncommonlywelljustnow,whenIwasteasingColonelForstertogiveusaballatMeryton?Withgreatenergy;butitisalwaysasubjectwhichmakesaladyenergetic.Youaresevereonus.Itwillbe_her_turnsoontobeteased,saidMissLucas.Iamgoingtoopentheinstrument,Eliza,andyouknowwhatfollows.Youareaverystrangecreaturebywayofafriend!--alwayswantingmetoplayandsingbeforeanybodyandeverybody!Ifmyvanityhadtakenamusicalturn,youwouldhavebeeninvaluable;butasitis,Iwouldreallyrathernotsitdownbeforethosewhomustbeinthehabitofhearingtheverybestperformers.OnMissLucasspersevering,however,sheadded,Verywell,ifitmustbeso,itmust.AndgravelyglancingatMr.Darcy,Thereisafineoldsaying,whicheverybodyhereisofcoursefamiliarwith:Keepyourbreathtocoolyourporridge;andIshallkeepminetoswellmysong.Herperformancewaspleasing,thoughbynomeanscapital.Afterasongortwo,andbeforeshecouldreplytotheentreatiesofseveralthatshewouldsingagain,shewaseagerlysucceededattheinstrumentbyhersisterMary,whohaving,inconsequenceofbeingtheonlyplainoneinthefamily,workedhardforknowledgeandaccomplishments,wasalwaysimpatientfordisplay.Maryhadneithergeniusnortaste;andthoughvanityhadgivenherapplication,ithadgivenherlikewiseapedanticairandconceitedmanner,whichwouldhaveinjuredahigherdegreeofexcellencethanshehadreached.Elizabeth,easyandunaffected,hadbeenlistenedtowithmuchmorepleasure,thoughnotplayinghalfsowell;andMary,attheendofalongconcerto,wasgladtopurchasepraiseandgratitudebyScotchandIrishairs,attherequestofheryoungersisters,who,withsomeoftheLucases,andtwoorthreeofficers,joinedeagerlyindancingatoneendoftheroom.Mr.Darcystoodneartheminsilentindignationatsuchamodeofpassingtheevening,totheexclusionofallconversation,andwastoomuchengrossedbyhisthoughtstoperceivethatSirWilliamLucaswashisneighbour,tillSirWilliamthusbegan:Whatacharmingamusementforyoungpeoplethisis,Mr.Darcy!Thereisnothinglikedancingafterall.Iconsideritasoneofthefirstrefinementsofpolishedsociety.Certainly,sir;andithastheadvantagealsoofbeinginvogueamongstthelesspolishedsocietiesoftheworld.Everysavagecandance.SirWilliamonlysmiled.Yourfriendperformsdelightfully,hecontinuedafterapause,onseeingBingleyjointhegroup;andIdoubtnotthatyouareanadeptinthescienceyourself,Mr.Darcy.YousawmedanceatMeryton,Ibelieve,sir.Yes,indeed,andreceivednoinconsiderablepleasurefromthesight.DoyouoftendanceatSt.Jamess?Never,sir.Doyounotthinkitwouldbeapropercomplimenttotheplace?ItisacomplimentwhichIneverpaytoanyplaceifIcanavoidit.Youhaveahouseintown,Iconclude?Mr.Darcybowed.Ihadoncehadsomethoughtoffixingintownmyself--forIamfondofsuperiorsociety;butIdidnotfeelquitecertainthattheairofLondonwouldagreewithLadyLucas.Hepausedinhopesofananswer;buthiscompanionwasnotdisposedtomakeany;andElizabethatthatinstantmovingtowardsthem,hewasstruckwiththeactionofdoingaverygallantthing,andcalledouttoher:MydearMissEliza,whyareyounotdancing?Mr.Darcy,youmustallowmetopresentthisyoungladytoyouasaverydesirablepartner.Youcannotrefusetodance,Iamsurewhensomuchbeautyisbeforeyou.And,takingherhand,hewouldhavegivenittoMr.Darcywho,thoughextremelysurprised,wasnotunwillingtoreceiveit,whensheinstantlydrewback,andsaidwithsomediscomposuretoSirWilliam:Indeed,sir,Ihavenottheleastintentionofdancing.IentreatyounottosupposethatImovedthiswayinordertobegforapartner.Mr.Darcy,withgravepropriety,requestedtobeallowedthehonourofherhand,butinvain.Elizabethwasdetermined;nordidSirWilliamatallshakeherpurposebyhisattemptatpersuasion.Youexcelsomuchinthedance,MissEliza,thatitiscrueltodenymethehappinessofseeingyou;andthoughthisgentlemandislikestheamusementingeneral,hecanhavenoobjection,Iamsure,toobligeusforonehalf-hour.Mr.Darcyisallpoliteness,saidElizabeth,smiling.Heis,indeed;but,consideringtheinducement,mydearMissEliza,wecannotwonderathiscomplaisance--forwhowouldobjecttosuchapartner?Elizabethlookedarchly,andturnedaway.Herresistancehadnotinjuredherwiththegentleman,andhewasthinkingofherwithsomecomplacency,whenthusaccostedbyMissBingley:Icanguessthesubjectofyourreverie.Ishouldimaginenot.Youareconsideringhowinsupportableitwouldbetopassmanyeveningsinthismanner--insuchsociety;andindeedIamquiteofyouropinion.Iwasnevermoreannoyed!Theinsipidity,andyetthenoise--thenothingness,andyettheself-importanceofallthosepeople!WhatwouldIgivetohearyourstricturesonthem!Youconjectureistotallywrong,Iassureyou.Mymindwasmoreagreeablyengaged.Ihavebeenmeditatingontheverygreatpleasurewhichapairoffineeyesinthefaceofaprettywomancanbestow.MissBingleyimmediatelyfixedhereyesonhisface,anddesiredhewouldtellherwhatladyhadthecreditofinspiringsuchreflections.Mr.Darcyrepliedwithgreatintrepidity:MissElizabethBennet.MissElizabethBennet!repeatedMissBingley.Iamallastonishment.Howlonghasshebeensuchafavourite?--andpray,whenamItowishyoujoy?ThatisexactlythequestionwhichIexpectedyoutoask.Aladysimaginationisveryrapid;itjumpsfromadmirationtolove,fromlovetomatrimony,inamoment.Iknewyouwouldbewishingmejoy.Nay,ifyouareseriousaboutit,Ishallconsiderthematterisabsolutelysettled.Youwillbehavingacharmingmother-in-law,indeed;and,ofcourse,shewillalwaysbeatPemberleywithyou.Helistenedtoherwithperfectindifferencewhileshechosetoentertainherselfinthismanner;andashiscomposureconvincedherthatallwassafe,herwitflowedlong.".getBytes();
    signature.update(message);
    byte[] sigBytes = signature.sign();
    long endTime   = System.nanoTime();
long totalTime = endTime - startTime;
System.out.println("TOTAL TIME!"+totalTime+" nanoseconds");

    signature.initVerify(keyPair.getPublic());
    signature.update(message);
    System.out.println(signature.verify(sigBytes));
  }
}